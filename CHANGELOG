# CHANGELOG
##############


Version 0.4.*: 
-----------
51: report skeletons added for all modules
50: Changed name to Snakebite-Holoruminant-MetaG
49: Moved large parts of the README.md to dedicated files located in docs/ 
48: More adjustments to dram distill output folder names
47: Added the eggnog 7 database for annotation
46: Adjusted the DRAM/distill path output for the tmp folder, which mihgt create problems on some systems.
45: Added more debug messages and graceful waiting time to rule read_annotate__kraken2__assign 
44: Turned the separate bin functions into a script file
43: Rule 'assemble__drep__separate_bins' works now more robust, important for provided assemblies
42: Changed mv command in mag_annotate__proteinortho from explicit to wildcards
41: Reverted update 40, cram stays standard, but introduced a new parameter in params where cram/bam can be chosen
40: Changed the default from cram to bam, as sometimes the header did not work
39: Removed the piping in rule assemble__bowtie2__map and split it rather in two separate steps, within the same rule though
38: Removed $TMPDIR echo from rule read_annotate__phyloflash__run
37: Removed product.html output from mag_annotate__dram_mag_distill as it is not always created
36: Added more echo messages to the logfile of assemble__bowtie2__map
35: Bugfix in assemble__bowtie2__map (missing fai index)
34: Log output added for cramToBam
33: Log output for hmmsearch added for contig annotate output
32: Diamond reports now per default only the top result
31: Harded-coded paths removed from the kegg summary R script
30: Added option to provide arbitrary named self-provided assemblies.
29: tmp folder for samtools sort adjusted to add sample_id and library_id
28: --keep-going removed from default run script
27: Critical bugfix in preprocess__bowtie2__extract_nonhost_run (crashed workflow)
26: Reversed change number 24
25: Option to provide an own, existing assembly added to the Assembler module
24: Added 'phyloflash' to Phyloflash output file, to avoid potential temp file mixups between tools
23: Improved decontamination avoiding misclassified singletons
22: Added HMMER to contig_annotate and set HydDB as starting db (issue #19)
21: Database files are now copied to avoid accidental overwriting during parallele execution (issue #18)
20: Added HydDB option as additional standard Diamond search database (issue #19)
19: Stand-alone contig_annotate__eggnog throws an error, due to an missing f-string (issue #24) 
18: Included the FastQC module for the preprocess fastqs
17: Updated the default database for Phyloflash to Silva 138.2
16: Updated the read_annotate/phyloflash docker image (downgrade spades 3.15.* to 3.14.1, spades froze often in 3.15.*)
15: Accidental overwriting of camper results and db fixed (copying removed for now, issue #18)
14: Added camper to mag_annotate from dram output
13: Output path bug in dram_mag fixed
12: Output path adjusted for phylophlan result (phylophlan.tsv.tsv -> phylophlan.tsv)
11: A few remaining proteinortho output files are now copied also the proteinortho output folde
10: Critial typo fixed in mag_annotate__phylophlan (issue #23)
9: Changed magscot rules so that also empty output is taken now into consideration and does not throw an error anymore (issue #22)
8: Output bugfix in Phyophlan (two arguments, unnamed)
7: Bugfix that prevented Kraken2 from copying db files to faster disc spaces
6: Removed a non-public referene database (ciliates) from features.yaml (issue #17)
5: Added --memory {resources.mem_mb}  to the metaspades rule (issue #15)
4: Flag to turn on/off shm storage for kraken2 added
3: Summary scripts for Diamond runs adjusted
2: Problem with dnmd file ending solved
1: Critical bugfix for read_annotate__diamond

Version 0.3.*:
--------------
65: annotate modue renamed to mag_annotate
64: Kraken2 has now a /dev/shm -> nvme -> orig failproof speedup
63: Totally overhauled escalation system added to all rules.
62: Option to turn off the use of /dev/shm drive
61: Puhti slurm profil adjsuted for output and error
60: Escalation system added to preprocess_diamond
59: Escalation system added to preprocess_bowtie2
58: Escalation function updated, it needs an additional argument to work dynamically
57: kraken rule chooses either the shm or the nvme disc, depending on db size and disc space availability
56: Fixed some log entries to avoid emtpy log files
55: Updated the README to be more explicit how to setup a fresh installed pipeline
54: Full_node resource set introduced in config/config.yaml
53: shm_storage introduced in config/config.yaml
52: Removed conda from quantify and added escalation rulesets to all quantify/*.smk files
51: Quantify is now part of the rule all
50: Cosmetic changes for the escalation setting
49: Fixed a bug that prevented a dryrun to run while escalating resources were defined
48: Added the singularity-prefix to the run script
47: Added resource sets, resource escalation functions and retries (trial in helpers__fastqc)
46: Sylph for contigs and mags removed for now
45: DRAM distill input fixed, annotation had wrong scaffold entry so output was too strongly condensed
44: Sylp added to annotate module
43: contig_annotate__sylp added
42: preprocess__sylph added
41: --keep-going added as default option to run the pipeline
40: Order of the host decontamination changed, to avoid sequence similarity problems between different genomes
39: Hard-coded threads in reference__hosts__recompress changed to variable
39: Added the missing proteinortho files to be moved into result folder
38: Fixed the output for proteinortho
37: Output for DRAM_mag rule adjusted
36: Function names for bowtie rules harmonised
35: Function call to contig_annotate__prodigal improved
34: Optional Debug comments added to the Snakefile
33: DRAM mag rules added
32: Adjusted the Output ruleset for contig_annotate__camper and moved from folder to concrete files
31: Apply proteinortho now on the set of proteins obtains from the different MAG sets
30: Added bakta annotation for each MAG separately instead of applying it to one dereplicated MAG-set only
29: Summary tables for Diamond added
28: Bowtie2 and Humann2 were moved to own docker container 
27: Added camper to contig_annotate
26: Names of many rules were adjusted to follow a similary naming scheme
25: Krona got an own singularity image, as it downversion bowtie2 in the same image for some reason
24: Re-enabled the splif-fasta for proteinortho input
23: Krona plots added for kraken2
22: Eggnog does not throw an error anymore in case that no fast nvme tmp folder is provided
21: Added the camper module to annotate
20: In annotate/GTDB-TK the annot and classify folders won't be deleted anymore
19: Sylph added
18: Added a new proteinortho rule that takes entire bakta output as input, not splitted
17: More nvme memory to eggnog assigned
16: Added the --skip-plot option as default to Bakta to prevent error for large MAGs (needs to be re-added later as separate step)
15: Protect the eggnog logs that they are not deleted in case of an error (could be removed after trouble shooting)
14: Added a config path to phylophlan
13: Changed bug in rule phylophlan -e was changed to --genome_extension
12: bakta uses now per default the option "--skip-crispr", as there was some unsolveable error with it (error code -6)
11: Time resource allocation for assemble_drep adjusted
10: Removed redundant rule calls from contig_assemble and avoid rerunning rules for already existing files
9: Preprocess rule output adjusted, to account for temp files
8: Decontaminated reads are now stored in a dedicated locations and other host/non-host reads are removed
7: Chromosome-wise quantification for host genomes added
6: Temporary output is now by default removed from HumanN 
5: Software requirements adjusted for installations
4: Added dedicated TMPDIR definitions to rules preprocess/ humann, metaphlan, nonpareil and singlem
3: Changed in _contigAnnotate__prodiga  sed to grep, to satisfy linter
2: Linter warnings fixed
1: Developer version (this version is similar to 0.2)

Version 0.2: First public release version (18.09.2024)
--------------
